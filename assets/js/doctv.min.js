function responsiveResize(){var e=$(window).width();768>e?$("body").addClass("_xs").removeClass("_sm _md _lg"):e>767&&992>e?$("body").addClass("_sm").removeClass("_xs _md _lg"):e>991&&1200>e?$("body").addClass("_md").removeClass("_xs _sm _lg"):e>1199&&$("body").addClass("_lg").removeClass("_xs _sm _md")}function CommentForm(){this.form=$(".box.comments.comment-form form"),this.note=$(".box.comments.comment-form .comment-notes"),this.result=$(".box.comments.comment-form .comment-result"),this.clearForm=function(e){return e.find("input[type=text], input[type=email], textarea").val(""),"object"==typeof grecaptcha&&grecaptcha.reset(),!0};(function(e){$form=e.form,$msg=e.note,$result=e.result,$form.find("input, textarea").on("focusin",function(){$msg.is(":hidden")&&$msg.slideDown()}),$form.on("submit",function(t){var a=$(this);if($(".g-recaptcha-response").length&&""===$(".g-recaptcha-response").val())return!1;var s=a.serialize();return $.ajax({url:a.attr("action"),data:s,type:a.attr("method"),success:function(t){var s=JSON.parse(t);switch($result.html(s.message),s.cssClass){case"k2FormLogSuccess":$result.removeClass("alert-danger").addClass("alert-success");break;case"k2FormLogError":$result.addClass("alert-danger").removeClass("alert-success")}$result.is(":hidden")&&$result.slideDown(),e.clearForm(a)}}),t.preventDefault(),!1})})(this)}function Feeds(e){this.obj=e,this.load=function(e,t,a,s){for(var i=window["items_"+e.tmpl],l=window["box_"+e.tmpl],r="",n="-1"==e.count?t.items.length:e.count,o=0;n>o;o++)r+=i.replace(/{site.url}/g,t.site.url).replace(/{category.link}/g,t.category.link).replace(/{item.link}/g,t.items[o].link).replace(/{item.imageSmall}/g,t.items[o].imageSmall).replace(/{item.title}/g,t.items[o].title);var c=l.replace(/{site.url}/g,t.site.url).replace(/{site.name}/g,t.site.name).replace(/{items}/g,r);a.parent().append(c),Helper.equalHeights(),"undefined"!=typeof e.carousel&&e.carousel===!0&&s.createCarousel(a.parent().find("ul"))},this.createCarousel=function(e){e.owlCarousel({margin:0,loop:!0,items:3,autoWidth:!1,rtl:!0,themeClass:"carousel-theme",baseClass:"items-carousel",itemClass:"item",animateOut:"",nav:!0,navText:["",""],responsive:{0:{items:2},480:{items:2},980:{items:3}}})};(function(e){return"undefined"==typeof e.obj?!1:void e.obj.each(function(){var t=JSON.parse($(this).attr("data-conf")),a=$(this);$.ajax({url:t.url,success:function(s){e.load(t,s,a,e)}})})})(this)}$(function(){if($("[data-toggle]").each(function(){var e=$(this).attr("data-target");$(this).on("click",function(t){switch($(e).stop(),$(this).attr("data-toggle")){case"scroll":$("html, body").animate({scrollTop:$(e).offset().top},"slow");break;case"slide":$(e).is(":visible")?$(e).slideUp("fast"):$(e).slideDown("fast");break;case"menuslide":$(this).parent().toggleClass("active"),$(e).is(":hidden")?$(e).slideDown("fast",function(){$(".header-anchors li").fadeIn(100)}):($(".header-anchors li").not(".lang-anchor").fadeOut(100),$(e).slideUp("fast"));break;case"toggle":$(this).parent().toggleClass("active"),$(e).is(":visible")?($(e).fadeOut("fast"),"#search"===e&&$("#header .search").hasClass("active")&&$("#header .search").removeClass("active")):$(e).fadeIn("fast"),"undefined"!=typeof $(this).attr("data-focus")&&$($(this).attr("data-focus")).focus()}t.preventDefault()})}),$(".search-toggle").on("click",function(){$("html").toggleClass("no-scroll")}),$(".page-tools").on("click",".clickable",function(e){if(!$(this).parent().hasClass("active")){var t=$(this).attr("data-style");"grid"===t?$(".box.episodes, .box.subcategories").addClass("grid"):$(".box.episodes, .box.subcategories").removeClass("grid"),$(".page-tools").find("li").removeClass("active"),$(this).parent().addClass("active")}e.preventDefault()}),$(".box.gallery").on("click",".thumbnail",function(e){var t=$(this).attr("href");$(".box.gallery .thumbs li").removeClass("active"),$(this).parents("li:first").addClass("active");var a=$(".box.gallery .preview").find("img");a.fadeOut(function(){a.attr("src",t).fadeIn()}),e.preventDefault()}),$("form[data-type=ajax]").on("submit",function(e){var t=$(this);if("false"===$(this).attr("data-eligibility"))return $(this).find(".alert-danger").length&&$(this).find(".alert-danger").fadeIn(),!1;if(t.find("input[name=file]").length&&("undefined"==typeof t.find("input[name=file]").val()||""===t.find("input[name=file]").val()))return alert("File not selected!"),!1;var a={data:t.serialize(),url:t.attr("action"),type:t.attr("method")},s=t.parent().find(".results-container");return $.ajax({url:a.url,data:a.data,type:a.type,success:function(e){s.addClass("alert-success").removeClass("alert-danger").html(e.msg)},error:function(e){e=JSON.parse(e.responseText),s.addClass("alert-danger").removeClass("alert-success").html(e.msg)}}),s.is(":hidden")&&s.fadeIn(),e.preventDefault(),!1}),$(".upload-form form").on("focusin","input, textarea",function(){"false"===$(this).parents("form").attr("data-eligibility")&&$(this).parents("form").find(".alert.alert-danger").fadeIn()}),$("#datepicker").length&&$("#datepicker").pDatepicker({enabled:!0,navigator:{text:{btnNextText:'<span>ماه بعد</span><i class="icon-left-open"></i>',btnPrevText:'<i class="icon-right-open"></i><span>ماه قبل</span>'},enabled:!1},toolbox:!1,maxDate:Math.floor(Date.now()-864e5),onSelect:function(e){date=new Date(e),$("#date-input").val(date.getFullYear()+"-"+(date.getMonth()+1)+"-"+date.getDate()),$("#load-schedule").submit()}}),$(".nano").length&&$(".nano").nanoScroller({alwaysVisible:!0}),$(".feed-holder").length&&new Feeds($(".feed-holder")),$(".item-image[data-video]").length&&$(".item-image[data-video]").each(function(){var e=$(this).find("img:first").attr("src"),t=$(this).attr("data-video");jwplayer($(this).attr("id")).setup({file:t,image:e,width:"100%",aspectratio:"16:9"})}),$(".box.comments.comment-form").length&&new CommentForm,$(".box.showcase").length&&BoxHelper.showcase(),$(".box.thumbs.carousel").length&&BoxHelper.thumbCarousels(),$(".box.special").length&&BoxHelper.special(),$(".ajax-upload").length&&$(".ajax-upload").fineUploader({multiple:!1,request:{endpoint:base+"api/ugc/file"},validation:{allowedExtensions:["jpg","jpeg","png","mp4","flv"],sizeLimit:20971520},debug:!0}).on("complete",function(e,t,a,s){s.success&&(console.log(e,t,a,s),$("input[name=file]").val(s.uuid+"/"+s.uploadName),$(".qq-upload-button-selector").fadeOut(function(){$(this).remove()}))}),$(".item-boxes .box.more").length){var e=$(".item-boxes .box.more"),t=e.find("ul"),a=e.attr("data-catlink");$.ajax({url:a,data:"format=json",success:function(e){"object"==typeof e&&(items=e.items,$.each(items,function(){item=Templates.tiles.replace(/{link}/g,this.link).replace(/{img}/g,this.image).replace(/{title}/g,this.title).replace(/{created}/g,this.time),t.append(item)}))}})}$(".search-form input[name=searchword]").keypress(function(e){$form=$(this).parents("form:first"),$results=$form.parent().find(".box");var t=Templates.searchItems;$(this).val().length>2&&"enter"!==e.key&&0!==e.which&&!e.ctrlKey&&!e.metaKey&&!e.altKey&&$.ajax({url:base+"?task=search&format=json&limit=8",data:$form.serialize(),success:function(e){if(e.items.length>0){var a="<div><ul>";$.each(e.items,function(){a+=t.replace(/{item.link}/g,this.link).replace(/{item.imageSmall}/g,this.imageSmall).replace(/{item.title}/g,this.title)}),a+="</ul></div>",$results.html(a),$results.is(":hidden")&&$results.slideDown()}else $results.slideUp()}})}),$("#program-list").length&&$.ajax({url:base+"api/programepisodes",success:function(e){$.each(e.items,function(){$("#program-list").append('<option value="'+this.id+'">'+this.name+"</option>")}),$("#program-list").select2({dir:"rtl"})}}),Helper.equalHeights(),responsiveResize(),$(".schedule-header-date").length&&$(".schedule-header-date").appendTo("h1")}),$(window).resize(function(){responsiveResize()});var Helper={equalHeights:function(){var e=450;return $(".full-height").each(function(){e=$(this).height()>e?$(this).height():e}),$(".full-height").height(e),e}},StringHelper={getFirstWord:function(e){return-1===e.indexOf(" ")?e:e.substr(0,e.indexOf(" "))},isInt:function(e){return"number"==typeof parseInt(e)&&isFinite(parseInt(e))&&parseInt(e)%1===0},ucfirst:function(e){return"undefined"!=typeof e?e.charAt(0).toUpperCase()+e.slice(1):e}},Templates={tiles:'<li><figure class="img"><a href="{link}"><img src="{img}" alt="{title}" /></a></figure><div class="desc"><div class="item-header"><h3 class="item-title"><a href="{link}">{title}</a></h3></div><time class="created">{created}</time></div></li>',searchItems:'<li><figure class="img"><a href="{item.link}"><img src="{item.imageSmall}" alt="{item.title}" /></a></figure><div class="desc"><h3><a href="{item.link}">{item.title}</a></h3></div></li>'},BoxHelper={showcase:function(){if($itemWidth=$(".box.showcase > div ul").find("li:first").width(),$showcaseItems=$(".box.showcase > div ul"),$showcaseItems.find("li").length>1){$showcaseItems.find("li").each(function(){$(this).width($itemWidth)}),$showcaseItems.on("changed.owl.carousel",function(e){var t=e.item.index;if(null!==t){var a=$(e.target).find(".item").eq(t+1).find("img"),s={src:a.attr("src"),alt:a.attr("alt")},i=$showcaseItems.parents(".box-wrapper:first").find(".active-img img");i.parent().append('<img src="'+s.src+'" alt="'+s.alt+'" />').promise().done(function(){i.fadeOut("slow").remove()})}});$showcaseItems.owlCarousel({margin:0,loop:!0,center:!0,items:1,autoWidth:!0,rtl:!0,themeClass:"carousel-theme",baseClass:"items-carousel",startPosition:5,itemClass:"item",animateOut:"",nav:!0,navText:["",""],autoplay:!0,autoplayTimeout:7e3,autoplayHoverPause:!0})}$(".box.showcase > .carousel ul").find("li").each(function(){$(this).width($itemWidth)})},thumbCarousels:function(){$(".box.thumbs.carousel > div ul").owlCarousel({margin:0,loop:!0,items:4,autoWidth:!1,rtl:!0,themeClass:"carousel-theme",baseClass:"items-carousel",itemClass:"item",animateOut:"",nav:!0,navText:["",""]})},special:function(){$itemWidth=$(".box.special > .carousel ul").find("li:first").width(),$(".box.special > div ul").owlCarousel({margin:0,loop:!0,center:!1,items:2,autoWidth:!1,rtl:!0,themeClass:"carousel-theme",baseClass:"items-carousel",itemClass:"item"})}};!function(e){function t(t){e(this).triggerHandler("trplclick",[t.data])}e.event.special.trplclick={setup:function(){e(this).bind("click",t)},teardown:function(){e(this).unbind("click",t)},add:function(t){var a=t.handler,s={minClickInterval:100,maxClickInterval:500,minPercentThird:85,maxPercentThird:130},i=!1,l=!1,r=[0,0,0],n=[0,0];t.handler=function(o){var c=Date.now(),m=e.extend({},s,o.data);if(r[1]&&c-r[1]>=m.maxClickInterval&&t.clearRuntime(),r[0]&&r[1]&&c-r[0]>=m.maxClickInterval&&t.clearRuntime(),l){r[2]=Date.now(),n[1]=r[2]-r[1];var d=100*(n[1]/n[0]);d>=m.minPercentThird&&d<=m.maxPercentThird&&a.apply(this,arguments),t.clearRuntime()}else i?i&&(r[1]=Date.now(),n[0]=r[1]-r[0],n[0]>=m.minClickInterval&&n[0]<=m.maxClickInterval?l=!0:t.clearRuntime()):(i=!0,r[0]=Date.now())},t.clearRuntime=function(){i=!1,l=!1,r[0]=0,r[1]=0,r[2]=0,n[0]=0,n[1]=0}}}}(jQuery);
