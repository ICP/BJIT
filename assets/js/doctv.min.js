function feedCarousels(e){e.owlCarousel({margin:0,loop:!0,items:3,autoWidth:!1,rtl:!0,themeClass:"carousel-theme",baseClass:"items-carousel",itemClass:"item",animateOut:"",nav:!0,navText:["",""],responsive:{0:{items:2},480:{items:2},980:{items:3}}})}function equalHeights(){var e=450;return $(".full-height").each(function(){e=$(this).height()>e?$(this).height():e}),$(".full-height").height(e),e}function loadExternalFeed(e,t,a){for(var i=window["items_"+e.tmpl],s=window["box_"+e.tmpl],l="",r="-1"==e.count?t.items.length:e.count,o=0;r>o;o++)l+=i.replace(/{site.url}/g,t.site.url).replace(/{category.link}/g,t.category.link).replace(/{item.link}/g,t.items[o].link).replace(/{item.imageSmall}/g,t.items[o].imageSmall).replace(/{item.title}/g,t.items[o].title);var n=s.replace(/{site.url}/g,t.site.url).replace(/{site.name}/g,t.site.name).replace(/{items}/g,l);a.parent().append(n),equalHeights(),"undefined"!=typeof e.carousel&&e.carousel===!0&&feedCarousels(a.parent().find("ul"))}$(function(){$("[data-toggle]").each(function(){var e=$(this).attr("data-target");$(this).on("click",function(t){switch($(e).stop(),$(this).attr("data-toggle")){case"scroll":$("html, body").animate({scrollTop:$(e).offset().top},"slow");break;case"slide":$(e).is(":visible")?$(e).slideUp("fast"):$(e).slideDown("fast");break;case"menuslide":$(this).parent().toggleClass("active"),$(e).is(":hidden")?$(e).slideDown("fast",function(){$(".header-anchors li").fadeIn(100)}):($(".header-anchors li").not(".lang-anchor").fadeOut(100),$(e).slideUp("fast"));break;case"toggle":$(this).parent().toggleClass("active"),$(e).is(":visible")?($(e).fadeOut("fast"),"#search"===e&&$("#header .search").hasClass("active")&&$("#header .search").removeClass("active")):$(e).fadeIn("fast"),"undefined"!=typeof $(this).attr("data-focus")&&$($(this).attr("data-focus")).focus()}t.preventDefault()})}),$(".search-toggle").click(function(){$("html").toggleClass("no-scroll")}),$(".item-image[data-video]").each(function(){var e=$(this).find("img:first").attr("src"),t=$(this).attr("data-video");jwplayer($(this).attr("id")).setup({file:t,image:e,width:"100%",aspectratio:"16:9"})}),$(".page-tools").on("click",".clickable",function(e){if(!$(this).parent().hasClass("active")){var t=$(this).attr("data-style");"grid"===t?$(".box.episodes, .box.subcategories").addClass("grid"):$(".box.episodes, .box.subcategories").removeClass("grid"),$(".page-tools").find("li").removeClass("active"),$(this).parent().addClass("active")}e.preventDefault()}),$(".nano").nanoScroller({alwaysVisible:!0});var e='<li><figure class="img"><a href="{link}"><img src="{img}" alt="{title}" /></a></figure><div class="desc"><div class="item-header"><h3 class="item-title"><a href="{link}">{title}</a></h3></div><time class="created">{created}</time></div></li>';if($(".item-boxes .box.more").length){var t=$(".item-boxes .box.more"),a=t.find("ul"),i=t.attr("data-catlink");$.ajax({url:i,data:"format=json",success:function(t){"object"==typeof t&&(items=t.items,$.each(items,function(){item=e.replace(/{link}/g,this.link).replace(/{img}/g,this.image).replace(/{title}/g,this.title).replace(/{created}/g,this.time),a.append(item)}))}})}$(".box.gallery").on("click",".thumbnail",function(e){var t=$(this).attr("href");$(".box.gallery .thumbs li").removeClass("active"),$(this).parents("li:first").addClass("active");var a=$(".box.gallery .preview").find("img");a.fadeOut(function(){a.attr("src",t).fadeIn()}),e.preventDefault()}),$itemWidth=$(".box.showcase > div ul").find("li:first").width(),$showcaseItems=$(".box.showcase > div ul"),$showcaseItems.find("li").each(function(){$(this).width($itemWidth)}),$showcaseItems.on("changed.owl.carousel",function(e){var t=e.item.index;if(null!==t){var a=$(e.target).find(".item").eq(t+1).find("img"),i={src:a.attr("src"),alt:a.attr("alt")},s=$showcaseItems.parents(".box-wrapper:first").find(".active-img img");s.parent().append('<img src="'+i.src+'" alt="'+i.alt+'" />').promise().done(function(){s.fadeOut("slow").remove()})}});$showcaseItems.owlCarousel({margin:0,loop:!0,center:!0,items:1,autoWidth:!0,rtl:!0,themeClass:"carousel-theme",baseClass:"items-carousel",startPosition:5,itemClass:"item",animateOut:"",nav:!0,navText:["",""]});$(".box.thumbs.carousel > div ul").owlCarousel({margin:0,loop:!0,items:4,autoWidth:!1,rtl:!0,themeClass:"carousel-theme",baseClass:"items-carousel",itemClass:"item",animateOut:"",nav:!0,navText:["",""]}),$itemWidth=$(".box.special > .carousel ul").find("li:first").width(),$(".box.showcase > .carousel ul").find("li").each(function(){$(this).width($itemWidth)}),$(".box.special > div ul").owlCarousel({margin:0,loop:!0,center:!1,items:2,autoWidth:!1,rtl:!0,themeClass:"carousel-theme",baseClass:"items-carousel",itemClass:"item"}),equalHeights(),$(".feed-holder").length&&$(".feed-holder").each(function(){var e=JSON.parse($(this).attr("data-conf")),t=$(this);$.ajax({url:e.url,success:function(a){loadExternalFeed(e,a,t)}})}),$("#datepicker").pDatepicker({enabled:!0,navigator:{text:{btnNextText:'<span>ماه بعد</span><i class="icon-left-open"></i>',btnPrevText:'<i class="icon-right-open"></i><span>ماه قبل</span>'},enabled:!1},toolbox:!1,maxDate:Math.floor(Date.now()-864e5),onSelect:function(e){date=new Date(e),$("#date-input").val(date.getFullYear()+"-"+(date.getMonth()+1)+"-"+date.getDate()),$("#load-schedule").submit()}}),$(".schedule-header-date").length&&$(".schedule-header-date").appendTo("h1");var s='<li><figure class="img"><a href="{item.link}"><img src="{item.imageSmall}" alt="{item.title}" /></a></figure><div class="desc"><h3><a href="{item.link}">{item.title}</a></h3></div></li>';$(".search-form input[name=searchword]").keypress(function(e){$form=$(this).parents("form:first"),$results=$form.parent().find(".box"),$(this).val().length>2&&"enter"!==e.key&&0!==e.which&&!e.ctrlKey&&!e.metaKey&&!e.altKey&&$.ajax({url:base+"?task=search&format=json&limit=8",data:$form.serialize(),success:function(e){if(e.items.length>0){var t="<div><ul>";$.each(e.items,function(){t+=s.replace(/{item.link}/g,this.link).replace(/{item.imageSmall}/g,this.imageSmall).replace(/{item.title}/g,this.title)}),t+="</ul></div>",$results.html(t),$results.is(":hidden")&&$results.slideDown()}else $results.slideUp()}})})});
